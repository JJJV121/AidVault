<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AidVault - Blockchain Aid</title>
<script src="https://cdn.jsdelivr.net/npm/web3@1.9.1/dist/web3.min.js"></script>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #1B0D3A;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
}
button {
    margin: 10px;
    padding: 10px 20px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    background-color: #6C63FF;
    color: white;
    font-weight: bold;
}
button:hover {
    background-color: #574bdb;
}
input {
    padding: 5px;
    margin: 5px;
    border-radius: 5px;
    border: none;
}
.card {
    background-color: white;
    color: #1B0D3A;
    padding: 15px;
    margin: 15px;
    border-radius: 10px;
    width: 320px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}
</style>
</head>
<body>

<h1>AidVault - Blockchain Aid</h1>

<div class="card">
    <button id="connectWallet">Connect Wallet</button>
    <p id="account">Not connected</p>
</div>

<div class="card">
    <h3>Request Grant (Beneficiary)</h3>
    <input type="number" id="grantAmount" placeholder="Amount (wei)">
    <button onclick="requestGrant()">Request</button>
</div>

<div class="card">
    <h3>Approve Grant (Admin)</h3>
    <input type="number" id="approveId" placeholder="Grant ID">
    <button onclick="approveGrant()">Approve</button>
</div>

<div class="card">
    <h3>Fund Grant (Donor)</h3>
    <input type="number" id="fundId" placeholder="Grant ID">
    <input type="number" id="fundAmount" placeholder="Amount (wei)">
    <button onclick="fundGrant()">Fund</button>
</div>

<div class="card">
    <h3>Check Grant</h3>
    <input type="number" id="checkId" placeholder="Grant ID">
    <button onclick="checkGrant()">Check</button>
    <p id="grantInfo"></p>
</div>

<script>
// ✅ Use your deployed contract address
const contractAddress = "0x664d83231bb5A9D0ACB2A463d6a53cC8992BCB48";

// ✅ Paste ABI from Remix here (Compiler → ABI → Copy)
const abi = [
    // ⚠️ REPLACE this with your actual ABI JSON from Remix
];

let web3;
let aidVault;
let currentAccount;

// Connect MetaMask wallet
async function connectWallet() {
    if (window.ethereum) {
        web3 = new Web3(window.ethereum);
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        const accounts = await web3.eth.getAccounts();
        currentAccount = accounts[0];
        document.getElementById("account").innerText = "Connected: " + currentAccount;
        aidVault = new web3.eth.Contract(abi, contractAddress);
        alert("Wallet connected!");
    } else {
        alert("Install MetaMask to use this app.");
    }
}

// Request Grant
async function requestGrant() {
    const amount = document.getElementById("grantAmount").value;
    await aidVault.methods.requestGrant(amount).send({ from: currentAccount });
    alert("Grant requested!");
}

// Approve Grant
async function approveGrant() {
    const id = document.getElementById("approveId").value;
    await aidVault.methods.approveGrant(id).send({ from: currentAccount });
    alert("Grant approved!");
}

// Fund Grant
async function fundGrant() {
    const id = document.getElementById("fundId").value;
    const amount = document.getElementById("fundAmount").value;
    await aidVault.methods.fundGrant(id).send({ from: currentAccount, value: amount });
    alert("Grant funded!");
}

// Check Grant
async function checkGrant() {
    const id = document.getElementById("checkId").value;
    const result = await aidVault.methods.getGrant(id).call();
    document.getElementById("grantInfo").innerText =
        `Beneficiary: ${result[0]}, Amount: ${result[1]}, Approved: ${result[2]}, Fulfilled: ${result[3]}`;
}

document.getElementById("connectWallet").addEventListener("click", connectWallet);
</script>

</body>
</html>
